# 示例<a name="ZH-CN_TOPIC_0124881432"></a>

本节通过调用EVS的API来创建云硬盘。

>![](public_sys-resources/icon-note.gif) **说明：**   
>通过IAM服务获取到的Token有效期为24小时，需要使用同一个Token鉴权时，可以先将Token缓存，避免频繁调用。  

## 涉及API<a name="zh-cn_topic_0121682346_section872994"></a>

当您使用Token认证方式完成认证鉴权时，需要获取用户Token并在调用接口时增加“X-Auth-Token”到业务接口请求消息头中。

-   IAM获取token的API
-   EVS创建云硬盘的API

## 具体步骤<a name="zh-cn_topic_0121682346_section7856948"></a>

1.  Token认证，具体操作请参考[获取请求认证](获取请求认证.md)。
2.  发送“POST  https://EVS的外部域名/v2/\{project\_id\}/cloudvolumes”。
3.  在Request Header中增加“X-Auth-Token”。
4.  在Request Body中传入参数如下：

    ```
    {
        "volume": {
            "count": 1,                        磁盘的个数
            "availability_zone": "az1.dc1",    所属az，必填
            "description": "test_volume_1",    描述信息
            "size": 120,                       磁盘容量，单位GB，必填
            "name": "test_volume_1",           磁盘名
            "volume_type": "SSD",              磁盘类型，必填
            "metadata": {}                     磁盘元数据，具体用法可参考接口详情
        }
    }
    ```

    请求响应成功后，返回job\_id。

    若请求失败，则会返回错误码及对应的错误信息说明，详细错误码信息请参考[错误码说明](错误码说明.md)。


1.  根据job\_id查询job详情，具体操作请参考[查询job的状态](查询job的状态.md)。

    查询job详情返回状态status为“SUCCESS”，则表示云硬盘创建成功。

    请求异常返回值说明请参考[错误码说明](错误码说明.md)。

2.  查询job详情的body体中可以获取到云硬盘ID，根据获取到的云硬盘ID可对云硬盘进行查询、挂载等操作。

